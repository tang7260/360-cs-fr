<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/apple-icon.png" />
    <link rel="icon" type="image/png" href="../assets/img/favicon.png" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>360</title>

    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />


    <!-- Bootstrap core CSS     -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />

    <!--  Material Dashboard CSS    -->
    <link href="assets/css/material-dashboard.css" rel="stylesheet" />
    <link href="assets/css/animate.css" rel="stylesheet" />

    <link href="assets/css/loading.css" rel="stylesheet" />
    <!--     Fonts and icons     -->
    <link href="assets/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300|Material+Icons' rel='stylesheet' type='text/css'>
    <link href="assets/css/demo.css" rel="stylesheet" />


    <style>
        .playpause {
            background-image: url(assets/img/play_button.png);
            background-repeat: no-repeat;
            width: 50%;
            height: 50%;
            position: absolute;
            left: 0%;
            right: 0%;
            top: 15%;
            bottom: 0%;
            margin: auto;
            background-size: contain;
            background-position: center;
        }
        
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background-color: #e0e0e0;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            border-radius: 10px;
            background-color: #7e7e7e;
        }
        
        .info {
            font-size: 17.5px;
            font-weight: 500;
            text-shadow: 2px 2px 30px rgba(0, 0, 0, 0.30);
            color: #2c2c2c;
        }
        
        .info_head {
            font-size: 16px;
            font-weight: 500;
            text-shadow: 2px 2px 30px rgba(0, 0, 0, 0.30);
            color: #717070;
        }
        
        .ctimes {
            font-size: 15px;
            font-weight: 400;
            text-shadow: 0px 0px 11px rgba(150, 150, 150, 1);
            color: #464646
        }
    </style>
</head>

<body>
    <div id='loading' style="width:50%;margin:25%">
        <div class="progress">
            <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width:100%">

            </div>
        </div>
        <h2 id="loading_text" style="margin-left:20vw;">Analyzing ...</h2>
    </div>
    <div class="wrapper">
        <div class="sidebar" data-color="red" data-image="assets/img/sidebar-1.jpg" style="display:none;">

            <!--
		        Tip 1: You can change the color of the sidebar using: data-color="purple | blue | green | orange | red"

		        Tip 2: you can also add an image using data-image tag
		    -->

            <div class="logo">
                <a href="index.html" class="simple-text">
					360
				</a>
            </div>

            <div class="sidebar-wrapper">
                <ul class="nav">
                    <li>
                        <a href="index.html">
                            <i class="material-icons">linked_camera</i>
                            <p>Raspberry Pi Camera</p>
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <i class="material-icons">settings</i>
                            <p>Camera Settings</p>
                        </a>
                    </li>
                    <li class="active">
                        <a href="media.html">
                            <i class="material-icons">perm_media</i>
                            <p>Media</p>
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <div class="wrapper">
            <nav class="navbar navbar-transparent navbar-absolute">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="media.html">&laquo; Back </a>
                    </div>
                    <div class="collapse navbar-collapse">
                        <ul class="nav navbar-nav navbar-right">
                            <li>
                                <a href="#pablo" class="dropdown-toggle" data-toggle="dropdown">
                                    <i class="material-icons">dashboard</i>
                                    <p class="hidden-lg hidden-md">Dashboard</p>
                                </a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                    <i class="material-icons">notifications</i>
                                    <span class="notification">5</span>
                                    <p class="hidden-lg hidden-md">Notifications</p>
                                </a>
                                <ul class="dropdown-menu">
                                    <li><a href="#">Mike John responded to your email</a></li>
                                    <li><a href="#">You have 5 new tasks</a></li>
                                    <li><a href="#">You're now friend with Andrew</a></li>
                                    <li><a href="#">Another Notification</a></li>
                                    <li><a href="#">Another One</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="#pablo" class="dropdown-toggle" data-toggle="dropdown">
                                    <i class="material-icons">person</i>
                                    <p class="hidden-lg hidden-md">Profile</p>
                                </a>
                            </li>
                        </ul>

                        <form class="navbar-form navbar-right" role="search">
                            <div class="form-group  is-empty">
                                <input type="text" class="form-control" placeholder="Search">
                                <span class="material-input"></span>
                            </div>
                            <button type="submit" class="btn btn-white btn-round btn-just-icon">
                                <i class="material-icons">search</i>
                                <div class="ripple-container"></div>
                            </button>
                        </form>
                    </div>
                </div>
            </nav>

            <div class="content">
                <div class="container-fluid">
                    <div style="margin:1.8%">
                        <h3 class="wow fadeInDown" style="margin-top:60px">Face Recognition Result - <span class='filename'></span></h3>
                        <div class="row" style="margin-top:0%">
                            <div class="col-lg-8 col-md-8 col-sm-12 wow fadeIn">
                                <div class="card card-stats">
                                    <div class="card-header wow fadeInDown" data-background-color="orange">
                                        <i class="material-icons">compare</i>
                                    </div>
                                    <div class="card-content wow fadeInDown">
                                        <!--                                <p class="category">Image</p>-->
                                        <h3 class="title"><span class='filename'></span> <small><span class='size'></span></small></h3>
                                        <h4 class="title"><span class='datetime'></span></h4>
                                    </div>

                                    <div class="card-footer wow fadeInDown">
                                        <div class="stats wow fadeInDown">
                                            <!--                                    <i class="material-icons text-danger">warning</i> <a href="#pablo">Get More Space...</a>-->
                                            <video id='result_video' class="pull-left wow fadeInDown" style="width:100%;height:auto;" controls preload="none" poster="media/result/demo7_result.mp4_th.jpg" onclick="playPause()">
                                                <source src="media/result/demo7_result.mp4" type="video/mp4"> Your browser does not support HTML5 video.
                                            </video>
                                            <div class="playpause" onclick="playPause()" style="display:none;"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-4 col-md-4 col-sm-12 wow fadeInDown">
                                <div class="card card-stats">
                                    <div class="card-header wow fadeInDown" data-background-color="red">
                                        <i class="material-icons">face</i>
                                    </div>
                                    <div class="card-content wow fadeInDown">
                                        <!--                                <p class="category">Image</p>-->
                                        <h3 class="title">The face in the video </h3>
                                        <h4 class="title"><small> per second</small></h4>
                                    </div>

                                    <div id="face" class="wow fadeInDown" style="max-height:62vh;overflow-y: auto;">
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-8 col-md-8 col-sm-12 wow fadeInDown">
                                <div class="card">
                                    <div class="card-header card-chart wow fadeInDown" data-background-color="blue">
                                        <div class="ct-chart" id="dailySalesChart"></div>
                                    </div>
                                    <div class="card-content wow fadeInDown">
                                        <h4 class="title">Total face analysis charts <small> per second</small></h4>
                                        <p class="category"><span class="text-success"><i class="fa fa-long-arrow-up"></i> <span class='avgface'></span></span> faces per second is the average recognition rate for this video </p>
                                    </div>
                                    <div class="card-footer wow fadeInDown">
                                        <div class="stats">
                                            <i class="material-icons">access_time</i> Video duration <span class='length'></span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-4 col-md-4 col-sm-12 wow fadeInDown">
                                <div class="card card-stats">
                                    <div class="card-header wow fadeInDown" data-background-color="green">
                                        <i class="material-icons">info_outline</i>
                                    </div>
                                    <div class="card-content wow fadeInDown">
                                        <!--                                <p class="category">Image</p>-->
                                        <h3 class="title">Information</h3>
                                        <br>

                                    </div>
                                    <div class="card-footer wow fadeInDown">
                                        <div class="stats">
                                            <!--                                    <i class="material-icons text-danger">warning</i> <a href="#pablo">Get More Space...</a>-->
                                            <h4 class="title info_head">Filename: <span class='filename info'></span></h4>
                                            <h4 class="title info_head">Record Datetime: <span class='datetime info'></span></h4>
                                            <h4 class="title info_head">File size: <span class='size info'></span></h4>
                                            <h4 class="title info_head">Average faces: <span class='avgface info'></span></h4>
                                            <h4 class="title info_head">Video Duration: <span class='length info'></span></h4>
                                            <h4 class="title info_head">Record by: <span class='recordby info'></span></h4>
                                            <h4 class="title info_head">FPS: <span class='fps info'></span></h4>
                                            <h4 class="title info_head">Width: <span class='width info'></span></h4>
                                            <h4 class="title info_head">Height: <span class='height info'></span></h4>
                                        </div>
                                    </div>
                                </div>
                            </div>


                        </div>

                        <div class="row"></div>

                        <div class="row">

                        </div>
                    </div>

                </div>
            </div>

            <footer class="footer">
                <div class="container-fluid">
                    <nav class="pull-left">
                        <ul>
                            <li>
                                <a href="index.html">
	                                Home 
	                            </a>
                            </li>
                            <li>
                                <a href="media.html">
	                               Media
	                            </a>
                            </li>
                        </ul>
                    </nav>
                    <p class="copyright pull-right">
                        &copy;
                        <script>
                            document.write(new Date().getFullYear())
                        </script> <a href="#">360</a> Camera System for surveillance with face recognition
                    </p>
                </div>
            </footer>
        </div>
    </div>

    <!-- Modal Core -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">Modal title</h4>
                </div>
                <div class="modal-body">
                    Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there live the blind texts. Separated they live in Bookmarksgrove right at the coast of the Semantics, a large language ocean. A small river named Duden flows by their place and supplies it with the necessary regelialia. It is a paradisematic country, in which roasted parts of sentences fly into your mouth. Even the all-powerful Pointing has no control about the blind texts it is an almost unorthographic life One day however a small line of blind text by the name of Lorem Ipsum decided to leave for the far World of Grammar.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default btn-simple" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-info btn-simple">Save</button>
                </div>
            </div>
        </div>
    </div>
</body>

<!--   Core JS Files   -->
<script src="assets/js/jquery-3.1.0.min.js" type="text/javascript"></script>
<script src="assets/js/bootstrap.min.js" type="text/javascript"></script>
<script src="assets/js/material.min.js" type="text/javascript"></script>
<script src="assets/js/jquery-ui.min.js"></script>
<script src="assets/js/wow.min.js"></script>

<!--  Charts Plugin -->
<script src="assets/js/chartist.min.js"></script>

<!--  Notifications Plugin    -->
<script src="assets/js/bootstrap-notify.js"></script>

<!-- Material Dashboard javascript methods -->
<script src="assets/js/material-dashboard.js"></script>
<script src="assets/js/demo.js"></script>
<script src="assets/js/face.js"></script>
<script>
    var lab = [];
    var ser = [];
    var pos = [];
    var times;
    var max;
    var avg;
    var faceImg = [];
    var vid = document.getElementById("result_video");

    function playPause() {
        if (vid.paused)
            vid.play();
        else
            vid.pause();
    }

    function getResult() {
        $.getJSON("get_result.php?type=video&filename=demo7.mp4", function (result) {
            max = 0;
            sum = 0;
            $.each(result['result_data'], function (i, v) {
                lab.push(v['video_position_str']);
                ser.push(v['total_face']);
                pos.push(parseInt(v['total_face']));
                faceImg.push(v['faceimg']);
                if (parseInt(v['total_face']) > max) {
                    max = parseInt(v['total_face']);
                }
                sum += parseInt(v['total_face']);
            });
            $.each(result["file_info"], function (i, v) {
                avg = parseInt(sum / result['result_data'].length);
                $('.filename').html(v["fileName"]);
                $('.datetime').html(v["recordDate"]);
                $('.size').html(v["fileSize"]);
                $('.length').html(v["duration"] + 's');
                $('.recordby').html(v["recordBy"]);
                $('.fps').html(v["fps"]);
                $('.width').html(v["width"]);
                $('.height').html(v["height"]);
                $('.avgface').html(avg);
            });
            max += 2;
            face.initFaceCharts(lab, ser, max);
            face.initFaceDiv(faceImg, lab);

            $('#loading').fadeOut(600);
            $('.wrapper').show();

        });

    }

    function indexFilter(element, index, array) {
        if (index <= times) {
            return true;
        } else {
            return false;
        }
    }

    function timeFilter(array, t) {
        filter = [];
        $.each(array, function (i, v) {
            if (i <= t) {
                filter.push(array[i]);
            } else {
                filter.push('');
            }
        });
        return filter;
    }

    $(document).ready(function () {
        new WOW().init();
        $('.wrapper').hide();
        $('#loading_text').html('Upload file to servers');
        setTimeout(function () {
            $('#loading_text').html('Analyzing ...');
        }, 3000);
        setTimeout(function () {
            $('#loading_text').html('Complete');
            getResult();
        }, 7000);
            

        vid.ontimeupdate = function () {
            times = parseInt(vid.currentTime);
            //postime = pos.filter(indexFilter);
            //labtime = lab.filter(indexFilter);
            //sertime = ser.filter(indexFilter);
            labtime = timeFilter(lab, times);
            sertime = timeFilter(ser, times);
            faceImgt = faceImg.filter(indexFilter);
            facelab = lab.filter(indexFilter);
            face.updateCharts(labtime, sertime, max);
            face.initFaceDiv(faceImgt, facelab);
        };

        vid.onplaying = function () {
            $(".playpause").fadeOut();
        }

        vid.onpause = function () {
            $(".playpause").fadeIn();
        }

    });
</script>

</html>